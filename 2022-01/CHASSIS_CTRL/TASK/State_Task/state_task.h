/*
						.'^:l!<~~+-+<<~>I^.                                                                                                               
					^I+?{}}{1/(}{}-_ut{{111~l".                                                                                                           
				:<[)1}]???-})}]"  >*Mv)--?]}{}_I'                       .":.                                                                             
				"<{({]?????????_X{,<rhWWq?f-?????[))>^                .  `<}{(|,                                                                            
			'l](1]-????????????bMoM8Woba+\1????????}{_`               "?1{?-_1x;.                                                                          
		. ~|([-??????????????]qkhahdqph?}|-?????????{{;            "_1{]{)|r}{\}{{}[]".                                                                   
		"/?r-???????????????-cpZ0Q0mpd//]????????????(}?jxxnnnj(}[)}??((}}JC-?]]]]?z_                                                                    
		`n; x[?????????????????})))))){[?????-?????????t{)Y0ZO0O0z1-????-?]fj]???--1Ql                                                                    
		}oYuO]????????????--____________---?[1]?????????t>I<1rLJ)-?????????--????{jUY'.                                                                   
		.'rkM&Q-??]??--_-?]}1\tjnvcXYJJJCCQQQZq\?????????-)u1]<-t]-?????????????-}uXXO{ .                                                                   
	. :/mOJ(??}(_?{tnUQZqpbkkkkkkhhhhhhhhhkat_?????????}u<?{r?????????????????xYXJv.                                                                     
		`1\/{_[-_?(X0qdddddddppppppppppddbbkkbh|-?????????}t;;>j-???????????????jYXXqX?^                                                                    
	`f)?{tvYJCmooppqwZ0QCUYXzccccvccczXYJ0qw]?????????-|};llj)-???????????-[xYXXQ(vmY1"   .                                                              
	<c(/fZ*#oo**wOCXcuunnnnnnnuuuuuuunnnnxUx_?????????]xillI>j)-????????-?|cYXX0|:IrZZC[. .                                                              
	`))--?jqoaoOcunnuuuuuuuuuuuuuuuuuuuunXz?????????-?j]IlllI!(/}?-??--](nXXXYU/\>;;{JZZnI                                                               
		.]\]-_]vk#XnuuuuujienijieniuuuuuunuYY[????????-[j]IlllllIi)(|){{(jcYYYUCc-;[f_l:l(Um0]                                                              
		l()?-_10Jnuuuuuuuuuuuuuuuuuuuuuczf?-?????--]\j<IlllIl~]?iI!~?1/xuucnt[lIlI<|)+l:l}zm/'                                                            
		`";}f)]_-fzvnuuuuuuuuuuuuuuuuvvxt}_?----?[)rz(!IlIl>+?_iIlllII;;;Il}I;Illllll+{(}>;;]Jz^ .                                                         
	^())(|//t/{-}jvcvuunnnnuuuvvccuj\]_-]}1(/rcUUf<;Il!+?_>lIllllllllllli\lllllllllII!?|1<;Ijn'                                                          
	"u{f/|){]}(\t()/jncccczcvvuxj/((\fxvcXUJJYr}i;I!<?]~!IlllllllllllllI~|IlllllllllllIl?/?l:[].                                                         
		?x/czu/??-?})\t\|(()))(\jxucXYUJJJYXvj1+!;li<+~<!IIlllllllIIIIllllI]);lllllllllllllI~j]!:+1.                                                        
		-/[\v1-------?]}1()|jYvvvvvuf\|{?~>!li+_}{[?__-?]]]]]]???__+~<i!l;([;llllllllllllllI+n_I:\<                                                        
		. f|+-]{)((1{}[]?--___((l!i>>>>~_~+?[{1\/{}{{{{{{{{{{{{{{{{{{{{{}[?v-!llllllllllllllII|j>I<{                                                        
		. (vxzYJCJUYXzcvunxjt|(X-]?-__~<>i~]}{{}|r(}{{{{{{{{{{{{{{{{{{{{{}fY){]+iIIIIllllllI?({\1(1\l"'                                                     
		`>++_?])tnzUJJJUYYYYXLiIlIIIIl~[{{{{{{}1tf1}{{{{{{{{{{{{{{{{{)\tnxjjxrr/{-~>i!lIl)(??-??]]}1)[!`                                                  
				.^I~[)jcXUJCO_!lIlli]{{{{{{{{{{{|j/1{{111111{{{1)\tft/(1{11))(\/t)]}{[(j{-??????????[))?I                                                
						'";!+-)]?_>>}{{1111111111{1tn/11111))(\/jjt|)))))))))((())([!;-f}-??????????????}\(l  .                                           
								^][<+|f\()1111)))))))1(juf/jrtt/\|((((((((((|||||||||\1{t??????????????????-[\):                                            
								.i[_{|\frrrf/|((\/fjrxxxuvuf(((||||||\\\\\\\\\\\\\\\\xY}--??????????????????-{f+                                           
								'>|f\((\/jrrzzxnjf/\\||\fnuj/\\\\\\////////////////CUzj{?--????????????????-?/?`  .                                      
									'!1/t\\||\tXt\\\\///////fxvvnf///tttttttttttttffuZYXXXvt{]--???????????????-{)_^.                                      
										,]frjt//jYt/ttttttttttttjnccnxjfffjjrxnuvvczXufvUJYYYXvj|{]?--??????????-])j_.                                      
										'l[/rxxXUxrjfffffffffjffjjxvzXucccvvvvXULX{__?}/uYYUYYYXcx/1]-???????-({:'                                        
											.:f()(|/jxnvzvunxrjjjjjjjvJnuucYJLQO0QQUt]----])jvYUUUYYYu1-?-]{{{}u/I                                         
											.f?-----??}cCCLCUUUXzYUcft1}+Ym00QQQQLQQYf}------[)/xcXXJU(-)n\\/\/[1}"                                       
											.\[????????]jXXXXXXYXYUJ-    !Q0QQQLLLCCCLUx(]-----__-?]1tnjj]-----?-)j^                                      
											<t-?????????)rcYYYXXXXXU1;.. }wQLLLCCCJJJJJUzx/(11{{}]-_--?-????????-\| .                                    
												+|]-????????-])/rnvczXYUL;   ]QQCCCJJJUUYUCQ0QXr\)(\tt(]-???????????-c!                                     
												:{)]?-???????---??]}1rCz`    Iv0JJJUUYYLQCYr{?-----?](r\???????????-r)                                     
												.l?(1}??-?????????-_1cI      `\QCYYYUOCXXj?-????????-?uf-?????????-t/                                     
													`I}ut|]??????--]\|"         lrCJYZJXXz}???????????_(U_?????????_j)                                     
													^]{f]?]}]?]{({>.            l(XOzXXc]???????????}z\-?????????-Xi                                     
														<1{[-{(1+:                 ILXXXX\-????????[\f1-????????--r(                                      
														..   '                   ..fJXXXXt[--???????--?????---]|Y/.                                      
																					..^xCYXXYcj|}]?--------?][1/uJc_                                        
																					']cUJYYYYXcnxjtt/tfrncUJX/<.                                         
																						'!1xvzYUUJCCCLLLQJzj(i`                                            
																							'"I><+_]?]-~i:'                                                
*/

#ifndef STATETASK_H
#define STATETASK_H
#include "main.h"
#include "FreeRTOSConfig.h"
#include "FreeRTOS.h"
#include "task.h"
#include "Remote_Control.h"
#include "stm32f4xx.h"
#include "stdbool.h"
#include "motor.h"

//通信串口标识符
typedef enum
{
    UART_6=0,
    UART_7,
    UART_8,
    USART_NUM
}USART_ID;

typedef enum
{
    Remote_StateNow=0,
    Remote_StateLast,
    Remote_StateNUM
}REMOTE_ID;

typedef __packed struct
{
    __packed struct  
    {
        uint32_t CAN1_RE_Time[Chassis_Motor_NUM];
        uint32_t USART_RE_time[USART_NUM];
        uint32_t Remote_Re_Time;
    }_Re_Time;

		 __packed union 
    {
        uint32_t CAN1_State;
        uint8_t CAN1_Receive[Chassis_Motor_NUM];
    }Can1;

		 __packed union 
    {
        uint32_t Motor_State;
        uint8_t CHASSISMotor_State[Chassis_Motor_NUM];
    }Chassis_Motor;
		
			__packed union 
    {
        uint32_t USART_State;
        uint8_t Irqhandler_State[USART_NUM];
    }Usart;
		
    uint8_t Remote[Remote_StateNUM];

}SYSTEM_STATE;

extern SYSTEM_STATE System_State;//系统状态

extern void state_task(void *pvParameters);
extern void State_Err_judge(SYSTEM_STATE *p);
extern void Chassis_Stop(void);
extern void Remote_Protect(RC_ctrl_t *p);
extern bool Judge_Re_Time(uint32_t _Re_Time);
extern bool Judge_IF_NAN(float _Output);

#endif

